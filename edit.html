<!DOCTYPE html>
<html>
    <head>
        <title>Obliterating Node's Core - Attic Jack</title>
        
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,800' rel='stylesheet' type='text/css'>
        <link href="main.css" rel="stylesheet" type="text/css">
        <link href="assets/css/tomorrow.css" rel="stylesheet" type="text/css">
    </head>
    
    <body>
        <div class="masthead">
            <div class="title">Reden<br>[Re]mote [D]evelopment [En]vironment</div>
        </div>
        
        <div class="editor body">
            <div class="full wrapper">
                <div class="content edit" id="content">Stuff goes in here, don't ya know! I know, I know, it seems really silly but at least we do aslidughiaougd foiguhsdf oiughsdo fughdosif ugoisduhf giusdhfg iusdfog iusdofiugh sodiufhg osdiufg osdiufhg osidufgsd</div>
                <textarea class="input" id="input">Woop woop!</textarea>
            </div>
            
            <div class="wrapper">
                <div class="footer">
                    <div class="faded wrapper">
                        Copyright, fools!
                    </div>
                </div>
            </div>
        </div>
        
        
        <script src="assets/js/highlight.pack.js"></script>
        <script src="assets/js/marked.min.js" type="text/javascript"></script>
        <script src="assets/js/autosize.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            var marking = false
            var ticking = false
            
            function update_scroll () {
                ticking = false
                
                if (marking) {
                    marking = false
                } else {
                    var window_scroll_y = window.scrollY
                    var window_inner_height = window.innerHeight

                    if (window_scroll_y < window_inner_height) {
                        input.style['margin-top'] = '0px'   
                    } else {
                        var content_height = content.scrollHeight
                        var input_height = input.scrollHeight

                        var difference = content_height - input_height

                        if (difference > 0) {
                            var offset = difference * ((window_scroll_y - window_inner_height) / (content_height - window_inner_height))

                            if (offset > 0) {
                                input.style['margin-top'] = offset + 'px'
                            }
                        }
                    }
                }   
            }
            
            function on_scroll () {
                if (!ticking) {
                    requestAnimationFrame(update_scroll)
                }
                
                ticking = true
            }

            window.addEventListener('scroll', on_scroll, false);
            
            marked.setOptions({
                highlight: function (code) {
                    return hljs.highlightAuto(code).value
                }
            })
            
            var content = document.getElementById('content')
            var input = document.getElementById('input')
            
            autosize(input)
            
            var mark = function() {
                marking = true
                
                content.innerHTML = marked(input.value)
                window.scrollTo(0,document.body.scrollHeight)
            }
            
            mark()
            
            input.oninput = mark
        </script>
    </body>
</html>